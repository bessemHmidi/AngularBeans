<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen"> 
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Angularbeans by bessemHmidi</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">
  
        <header>
        <div align="center">
        <img src="images/AngularBeans_logo_transparent.png" width="30%" height="30%"></img>
          <h2>AngularBeans : Step By Step Tutorial</h2>
          </div>
        </header>
        <hr>

<section id="main_content">
          
<br/><a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span class="octicon octicon-link"></span>
</a>
<h2>STEP6: ModelQuery</h2>

    
   <br/>
Consider the following class:
 <br/>    <br/>   

    <!-- HTML generated using hilite.me --><div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #cd00cd">package</span> <span style="color: #cccccc">examples</span><span style="color: #3399cc">.</span><span style="color: #cccccc">angularbeans</span><span style="color: #3399cc">;</span>

<span style="color: #cd00cd">import</span> <span style="color: #cccccc">java.text.SimpleDateFormat</span><span style="color: #3399cc">;</span>
<span style="color: #cd00cd">import</span> <span style="color: #cccccc">java.util.Date</span><span style="color: #3399cc">;</span>

<span style="color: #cd00cd">import</span> <span style="color: #cccccc">javax.inject.Inject</span><span style="color: #3399cc">;</span>
<span style="color: #cd00cd">import</span> <span style="color: #cccccc">javax.inject.Named</span><span style="color: #3399cc">;</span>
<span style="color: #cd00cd">import</span> <span style="color: #cccccc">angularBeans.api.http.Post</span><span style="color: #3399cc">;</span>
<span style="color: #cd00cd">import</span> <span style="color: #cccccc">angularBeans.api.http.Put</span><span style="color: #3399cc">;</span>

<span style="color: #cd00cd">import</span> <span style="color: #cccccc">angularBeans.api.AngularBean</span><span style="color: #3399cc">;</span>
<span style="color: #cd00cd">import</span> <span style="color: #cccccc">angularBeans.util.ModelQuery</span><span style="color: #3399cc">;</span>

<span style="color: #cccccc">@AngularBean</span>
<span style="color: #cccccc">@Named</span><span style="color: #3399cc">(</span><span style="color: #cd0000">&quot;superBean&quot;</span><span style="color: #3399cc">)</span>
<span style="color: #00cd00">public</span> <span style="color: #00cd00">class</span> <span style="color: #00cdcd">MySecondBean</span> <span style="color: #3399cc">{</span>

	<span style="color: #cccccc">@Inject</span>
	<span style="color: #cccccc">ModelQuery</span> <span style="color: #cccccc">model</span><span style="color: #3399cc">;</span>

	<span style="color: #00cd00">public</span> <span style="color: #00cd00">void</span> <span style="color: #cccccc">updateTime</span><span style="color: #3399cc">()</span> <span style="color: #3399cc">{</span>
		<span style="color: #cccccc">model</span><span style="color: #3399cc">.</span><span style="color: #cccccc">setProperty</span><span style="color: #3399cc">(</span><span style="color: #cd0000">&quot;date&quot;</span><span style="color: #3399cc">,</span>
				<span style="color: #cdcd00">new</span> <span style="color: #cccccc">SimpleDateFormat</span><span style="color: #3399cc">(</span><span style="color: #cd0000">&quot;dd/MM/yyyy&quot;</span><span style="color: #3399cc">).</span><span style="color: #cccccc">format</span><span style="color: #3399cc">(</span><span style="color: #cdcd00">new</span> <span style="color: #cccccc">Date</span><span style="color: #3399cc">()))</span>
				<span style="color: #3399cc">.</span><span style="color: #cccccc">setProperty</span><span style="color: #3399cc">(</span><span style="color: #cd0000">&quot;time&quot;</span><span style="color: #3399cc">,</span>
						<span style="color: #cdcd00">new</span> <span style="color: #cccccc">SimpleDateFormat</span><span style="color: #3399cc">(</span><span style="color: #cd0000">&quot;hh:mm:ss&quot;</span><span style="color: #3399cc">).</span><span style="color: #cccccc">format</span><span style="color: #3399cc">(</span><span style="color: #cdcd00">new</span> <span style="color: #cccccc">Date</span><span style="color: #3399cc">()));</span>
	<span style="color: #3399cc">}</span>

	<span style="color: #cccccc">@Put</span>
	<span style="color: #00cd00">public</span> <span style="color: #00cd00">void</span> <span style="color: #cccccc">addTask</span><span style="color: #3399cc">(</span><span style="color: #cccccc">Task</span> <span style="color: #cccccc">task</span><span style="color: #3399cc">)</span> <span style="color: #3399cc">{</span>
		<span style="color: #000080">// business logic here</span>
		<span style="color: #cccccc">model</span><span style="color: #3399cc">.</span><span style="color: #cccccc">pushTo</span><span style="color: #3399cc">(</span><span style="color: #cd0000">&quot;tasks&quot;</span><span style="color: #3399cc">,</span> <span style="color: #cccccc">task</span><span style="color: #3399cc">).</span><span style="color: #cccccc">setProperty</span><span style="color: #3399cc">(</span><span style="color: #cd0000">&quot;taskToAdd&quot;</span><span style="color: #3399cc">,</span> <span style="color: #cd0000">&quot;&quot;</span><span style="color: #3399cc">);</span>

	<span style="color: #3399cc">}</span>

	<span style="color: #cccccc">@Post</span>
	<span style="color: #00cd00">public</span> <span style="color: #00cd00">void</span> <span style="color: #cccccc">deleteTask</span><span style="color: #3399cc">(</span><span style="color: #cccccc">String</span> <span style="color: #cccccc">name</span><span style="color: #3399cc">)</span> <span style="color: #3399cc">{</span>
		<span style="color: #000080">// Retrieved from data base by name (for example).</span>
		<span style="color: #cccccc">Task</span> <span style="color: #cccccc">task</span> <span style="color: #3399cc">=</span> <span style="color: #cdcd00">new</span> <span style="color: #cccccc">Task</span><span style="color: #3399cc">();</span>
		<span style="color: #cccccc">task</span><span style="color: #3399cc">.</span><span style="color: #cccccc">setName</span><span style="color: #3399cc">(</span><span style="color: #cccccc">name</span><span style="color: #3399cc">);</span>

		<span style="color: #cccccc">model</span><span style="color: #3399cc">.</span><span style="color: #cccccc">removeFrom</span><span style="color: #3399cc">(</span><span style="color: #cd0000">&quot;tasks&quot;</span><span style="color: #3399cc">,</span> <span style="color: #cccccc">task</span><span style="color: #3399cc">,</span> <span style="color: #cd0000">&quot;name&quot;</span><span style="color: #3399cc">);</span>
	<span style="color: #3399cc">}</span>

<span style="color: #3399cc">}</span>
</pre></td></tr></table></div>

    <br/>
    <br/>
    
    And the HTML:
    
    <!-- HTML generated using hilite.me --><div style="background: #000000; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #000080">&lt;!DOCTYPE html&gt;</span>
<span style="color: #cccccc">&lt;html</span> <span style="color: #cccccc">data-ng-app=</span><span style="color: #cd0000">&quot;myModule&quot;</span><span style="color: #cccccc">&gt;</span>
<span style="color: #cccccc">&lt;head&gt;</span>
<span style="color: #cccccc">&lt;meta</span> <span style="color: #cccccc">charset=</span><span style="color: #cd0000">&quot;ISO-8859-1&quot;</span><span style="color: #cccccc">&gt;</span>
<span style="color: #cccccc">&lt;title&gt;</span>example1<span style="color: #cccccc">&lt;/title&gt;</span>
<span style="color: #cccccc">&lt;script type=</span><span style="color: #cd0000">&quot;text/javascript&quot;</span>
	<span style="color: #cccccc">src=</span><span style="color: #cd0000">&quot;bower_components/angular/angular.min.js&quot;</span><span style="color: #cccccc">&gt;&lt;/script&gt;</span>
<span style="color: #cccccc">&lt;script type=</span><span style="color: #cd0000">&quot;text/javascript&quot;</span> <span style="color: #cccccc">src=</span><span style="color: #cd0000">&quot;angular-beans.js&quot;</span><span style="color: #cccccc">&gt;&lt;/script&gt;</span>

<span style="color: #cccccc">&lt;script type=</span><span style="color: #cd0000">&quot;text/javascript&quot;</span><span style="color: #cccccc">&gt;</span>
	<span style="color: #cccccc">angular.module(</span><span style="color: #cd0000">&quot;myModule&quot;</span><span style="color: #cccccc">,</span> <span style="color: #cccccc">[</span> <span style="color: #cd0000">&quot;angularBeans&quot;</span> <span style="color: #cccccc">]).controller(</span>
			<span style="color: #cd0000">&quot;SecondCtrl&quot;</span><span style="color: #cccccc">,</span>

			<span style="color: #00cd00">function</span><span style="color: #cccccc">($scope,</span> <span style="color: #cccccc">superBean)</span> <span style="color: #cccccc">{</span>

				<span style="color: #cccccc">angularBeans.bind($scope,</span> <span style="color: #cccccc">superBean,</span> <span style="color: #cccccc">[</span> <span style="color: #cd0000">&quot;date&quot;</span><span style="color: #cccccc">,</span> <span style="color: #cd0000">&quot;time&quot;</span><span style="color: #cccccc">,</span> <span style="color: #cd0000">&quot;tasks&quot;</span><span style="color: #cccccc">,</span>
						<span style="color: #cd0000">&quot;taskToAdd&quot;</span> <span style="color: #cccccc">]);</span>
			<span style="color: #cccccc">});</span>
<span style="color: #cccccc">&lt;/script&gt;</span>

<span style="color: #cccccc">&lt;/head&gt;</span>
<span style="color: #cccccc">&lt;body</span> <span style="color: #cccccc">ng-controller=</span><span style="color: #cd0000">&quot;SecondCtrl&quot;</span><span style="color: #cccccc">&gt;</span>

	<span style="color: #cccccc">&lt;button</span> <span style="color: #cccccc">ng-click=</span><span style="color: #cd0000">&quot;superBean.updateTime()&quot;</span><span style="color: #cccccc">&gt;</span>update time<span style="color: #cccccc">&lt;/button&gt;</span>
	<span style="color: #cccccc">&lt;h2&gt;</span>{{date}}<span style="color: #cccccc">&lt;/h2&gt;</span>
	<span style="color: #cccccc">&lt;br</span> <span style="color: #cccccc">/&gt;</span>
	<span style="color: #cccccc">&lt;h2&gt;</span>{{time}}<span style="color: #cccccc">&lt;/h2&gt;</span>

	<span style="color: #cccccc">&lt;label&gt;</span>new Task: <span style="color: #cccccc">&lt;/label&gt;</span>
	<span style="color: #cccccc">&lt;input</span> <span style="color: #cccccc">type=</span><span style="color: #cd0000">&quot;text&quot;</span> <span style="color: #cccccc">data-ng-model=</span><span style="color: #cd0000">&quot;taskToAdd&quot;</span><span style="color: #cccccc">&gt;</span>
	<span style="color: #cccccc">&lt;button</span> <span style="color: #cccccc">ng-click=</span><span style="color: #cd0000">&quot;superBean.addTask({name:taskToAdd})&quot;</span><span style="color: #cccccc">&gt;</span>add<span style="color: #cccccc">&lt;/button&gt;</span>


	<span style="color: #cccccc">&lt;ul&gt;</span>
		<span style="color: #cccccc">&lt;li</span> <span style="color: #cccccc">ng-repeat=</span><span style="color: #cd0000">&quot;task in tasks&quot;</span><span style="color: #cccccc">&gt;</span>{{task.name}} {{task.completed}}
			<span style="color: #cccccc">&lt;button</span> <span style="color: #cccccc">ng-click=</span><span style="color: #cd0000">&quot;superBean.deleteTask(task.name)&quot;</span><span style="color: #cccccc">&gt;</span>delete<span style="color: #cccccc">&lt;/button&gt;</span>
		<span style="color: #cccccc">&lt;/li&gt;</span>

	<span style="color: #cccccc">&lt;/ul&gt;</span>



<span style="color: #cccccc">&lt;/body&gt;</span>
<span style="color: #cccccc">&lt;/html&gt;</span>
</pre></td></tr></table></div>

    <br/>
    
    Now if you look at the MySecondBean you will see another  annotation used on top of it: @Named this CDI annotaion will allow us to give a name to ower Angular Bean, and this will be the name of the angularJS injected service (instead of the className with a first lowerCase character). 
    
But also this class include a new injected bean : ModelQuery:
this bean is used to create a kind of a query but from the server to the clients, to update javascript side beans,that is very convenient if we are looking to change state of properties that only exist on the client side (we dont have the @NGModel match on the CDI bean).

In ower example, line 22 and 24 change 2 properties "date" and "time", of course, i  mean the js proxy properties (the generated service "superBean").
And with "angularBreans.bind(...)" on the client side we assure the synchronization with the bounded scope. In other worlds, the changes will be applied directly to the view.
<br/> 
At line 31,the model.pushTo(..) method will simply add a value to an existing array "tasks". And set the value of the property "taskToAdd" to an empty String, as a result, you will see the new task in the task list,and the text field will be cleared.

    <p>
 When removing or adding a new element on an array with the model query, we can provide an "equality key" as third parameter, that mean the removeFrom(...) at line 41 will remove the item who has an equal "name" with the task passed as parameter otherwise the equality will be based on a perfect match. (all the properties of the array item and the object passed to the method are equals).
    </p>
     <hr>
   <h2> next step: </h2> 
     
    <a href="Step-by-Step-Tutorial-angularBeans-events.html"><h2 style= "color:green">&lt;STEP7: Working with events></STEP2:></h2></a>
   
          <hr><hr><br>
    <h3>

<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>Having trouble with Pages? Check out the documentation at <a href="https://help.github.com/pages">https://help.github.com/pages</a> or contact <a href="mailto:support@github.com">support@github.com</a> and weâ€™ll help you sort it out.</p>
       
   
    
        </section>

        <footer>
          Angularbeans is maintained by <a href="https://github.com/bessemHmidi">bessemHmidi</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>